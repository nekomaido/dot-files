# Split windows - preserve current path
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# New window - preserve current path
bind c new-window -c "#{pane_current_path}"

# Custom bindings
# bind-key C run-shell "$HOME/.tmuxifier/bin/tmuxifier load-window claude-dev"

# maximize
bind -r m resize-pane -Z

##### Display Popups #####

# Lazygit popup (prefix + z)
bind z display-popup \
  -d "#{pane_current_path}" \
  -w 80% \
  -h 80% \
  -E "TMPDIR=$(getconf DARWIN_USER_TEMP_DIR) lazygit"

# Edit .zshrc in a popup (prefix + e)
bind e display-popup \
  -d "#{pane_current_path}" \
  -w 80% \
  -h 80% \
  -E "nvim ~/.zshrc"

# Yazi file manager (prefix + y)
bind y run-shell "tmux send-keys 'y' Enter"

# Vim mode
setw -g mode-keys vi

##### Vim-Tmux Navigator #####
# Smart pane switching with awareness of Vim splits
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|l?n?vim?x?)(diff)?$'"
bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'
bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R

# Prefix + hjkl for pane selection (fallback)
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# Resize panes with Ctrl + Shift + H/J/K/L
bind-key -n C-H resize-pane -L 5
bind-key -n C-J resize-pane -D 5
bind-key -n C-K resize-pane -U 5
bind-key -n C-L resize-pane -R 5
